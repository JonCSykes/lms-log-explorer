services:
  lms-log-explorer:
    build:
      context: .
      dockerfile: Dockerfile
    image: lms-log-explorer:local
    ports:
      - "${LMS_LOG_EXPLORER_PORT}:3000"
    environment:
      NODE_ENV: production
      NODE_OPTIONS: "--max-old-space-size=${NODE_MAX_OLD_SPACE_SIZE:-4096}"
      LMS_LOG_ROOT: /logs
      LMS_INDEX_DB_PATH: /data/index.sqlite
    volumes:
      - "${LMS_LOG_ROOT_HOST}:/logs:ro"
      - lms-log-explorer-data:/data
    restart: unless-stopped

volumes:
  lms-log-explorer-data:
